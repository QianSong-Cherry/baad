```{r, echo=FALSE}
source('report/report-fun.R')
options(width =160)

# Load all data
data <- loadStudies(reprocess=FALSE)$data

spLevelInfo  <-  function(data){
  spec         <-  data.frame(species=as.character(unique(data$species)), stringsAsFactors=FALSE)
  for(z in c("family", "pft")){
    spec[[z]]  <-  as.character(data[[z]][match(spec$species,data$species)])
    i          <-  spec[[z]]=="" | is.na(spec[[z]]) 
    if(any(i)){
      spec[[z]][i]  <-  "????"
    }
  }
  j            <-  spec$species=="" | is.na(spec$species) 
  if(any(j)){
    spec$species[j]  <-  "????"
  }
  spec
}

```


## Study details

### Location

**Global map**

```{r echo=FALSE, fig.width=8, fig.height=6, message=FALSE, warning=FALSE}
prepdata  <-  prepMapInfo(data)
drawWorldPlot (prepdata)
```


### Species data

```{r echo=FALSE, message=FALSE, warning=FALSE, comment=''}
(spLevelInfo(data))

```

## Plots of data

```{r fig.height=8, fig.width=8, echo=FALSE, warning=FALSE, message=FALSE}
bivarPlot(data, "h.t", "a.lf")

tmp <- bivarPlotColorBy(data, "m.lf", "h.t",colorBy = data$vegetation)
bivarPlot.Legend(tmp)

tmp <- bivarPlotColorBy(data, "a.lf", "h.t",colorBy = data$pft)
bivarPlot.Legend(tmp)

tmp <- bivarPlotColorBy(data, "m.ss", "h.t",  colorBy = data$vegetation)
bivarPlot.Legend(tmp)


tmp<-bivarPlotColorBy(data, "h.t", "a.lf", colorBy = data$vegetation)
bivarPlot.Legend(tmp)
bivarPlot.Legend(tmp)
tmp <- bivarPlotColorBy(data, "m.t", "h.t",  colorBy = data$vegetation)
bivarPlot.Legend(tmp)
tmp <- bivarPlotColorBy(data, "m.to", "h.t",  colorBy = data$vegetation)
bivarPlot.Legend(tmp)
source('report/report-fun.R')
tmp <- bivarPlotColorBy(data, "m.st", "h.t",  colorBy = data$vegetation)
bivarPlot.Legend(tmp)
tmp <- bivarPlotColorBy(data, "m.ss", "h.t",  colorBy = data$vegetation)
bivarPlot.Legend(tmp)
tmp <- bivarPlotColorBy(data, "m.lf", "h.t",  colorBy = data$vegetation)
bivarPlot.Legend(tmp)
tmp <- bivarPlotColorBy(data, "m.rt", "h.t",  colorBy = data$vegetation)
bivarPlot.Legend(tmp)
tmp <- bivarPlotColorBy(data, "m.sh", "h.t",  colorBy = data$vegetation)
bivarPlot.Legend(tmp)
tmp <- bivarPlotColorBy(data, "a.st", "a.lf",  colorBy = data$vegetation)
tmp <- bivarPlotColorBy(data, "a.ssba", "a.lf",  colorBy = data$vegetation)
tmp <- bivarPlotColorBy(data, "a.stba", "a.lf",  colorBy = data$vegetation)
tmp <- bivarPlotColorBy(data, "a.stbh", "a.lf",  colorBy = data$vegetation)
tmp <- bivarPlotColorBy(data, "m.st", "m.lf",  colorBy = data$vegetation)


```


  
  
  