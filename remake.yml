packages:
  - plyr
  - rmarkdown
  - knitr
  - maps
  - mapdata
  - taxize
  - methods
  - bibtex
  - devtools

sources:
  - R

include:
  # This file is automatically generated and is quite large.  It defines
  # targets for each data set, plus the 'baad' target.
  - remake_data.yml
  # This defines all the reports and including it greatly slows down
  # remake (both in the startup time and in checking the dependency
  # graph).  Commenting it out might be useful sometimes.
  - remake_reports.yml

targets:
  all:
    depends:
      - baad
      - export
  everything:
    depends:
      - export
      - reports

  compiler_contacts:
    command: read_csv("config/contact.csv")

  ## exporting targets
  export:
    depends:
      - export/baad.rds
      - export/baad_data.csv
      - export/baad_contacts.csv
      - export/baad_references.csv
      - export/baad_metadata.csv
      - export/baad_methods.csv
      - export/baad.bib
      - export/baad_dictionary.csv

  export/baad.rds:
    command: saveRDS(baad, target_name)
  export/baad_data.csv:
    command: write_csv(baad_data, target_name)
  export/baad_contacts.csv:
    command: write_csv(baad_contacts, target_name)
  export/baad_references.csv:
    command: write_csv(baad_references, target_name)
  export/baad_metadata.csv:
    command: write_csv(baad_metadata, target_name)
  export/baad_methods.csv:
    command: write_csv(baad_methods, target_name)
  export/baad.bib:
    command: write.bib(baad_bibtex, target_name)
    quiet: true
  export/baad_dictionary.csv:
    command: write_csv(baad_dictionary, target_name)

  ## baad elements
  baad_data:
    command: extract_baad_data(baad)
  baad_contacts:
    command: extract_baad_contacts(baad)
  baad_references:
    command: extract_baad_references(baad)
  baad_metadata:
    command: extract_baad_metadata(baad)
  baad_methods:
    command: extract_baad_methods(baad)
  baad_bibtex:
    command: extract_baad_bibtex(baad)
  baad_dictionary:
    command: extract_baad_dictionary(baad)

  release/baad_data.zip:
    command: make_release_baad_data_zip(target_name)
    depends: export
  release/baad.zip:
    command: make_release_baad_code_zip(target_name)
  release/baad.rds:
    command: file.copy("export/baad.rds", target_name)

  release:
    depends:
      - release/baad_data.zip
      - release/baad.zip
      - release/baad.rds
